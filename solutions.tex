\documentclass{article}

\usepackage{fancyhdr}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{MnSymbol}
\usepackage{kbordermatrix}

\newcommand{\w}[0]{\omega}
\newcommand{\z}[0]{\zeta}
\newcommand{\Q}[0]{\mathbb{Q}}
\newcommand{\R}[0]{\mathbb{R}}
\newcommand{\Z}[0]{\mathbb{Z}}
\newcommand{\zquad}[1]{\mathbb{Z}[\sqrt{#1}]}
\newcommand{\qext}[1]{\mathbb{Q}[#1]}
\newcommand{\zext}[1]{\mathbb{Z}[#1]}
\newcommand{\trace}[1]{\text{Tr}(#1)}
\newcommand{\norm}[1]{\text{N}(#1)}
\newcommand{\disc}[1]{\text{disc}(#1)}
\newcommand{\modequiv}[3]{#1 \equiv #2\ (#3)}
\newcommand{\modnotequiv}[3]{#1 \not\equiv #2\ (#3)}
\newcommand{\ringofintegers}[1]{\mathbb{A} \cap #1}

\begin{document}

\section*{Chapter 2}

\begin{enumerate}

\item[1. (a)] Show every number field of degree 2 over $\mathbb{Q}$ is one of the quadratic fields.

Let $K$ be a number field of degree 2, and $f(x) = x^2 + px + q$ be its minimum polynomial over $\mathbb{Q}$.  Since $p, q \in \mathbb{Q}$ we can multiply through to clear the denominators and give us a polynomial $g(x) = ax^2 + bx + c$ over $\mathbb{Z}$ with the same roots as $f(x)$.  Therefore $K = \mathbb{Q}[\sqrt{b^2 - 4ac}]$ is a quadratic field for $m = b^2 - 4ac$.

\item[1. (b)] Suppose $K = \mathbb{Q}[\sqrt{m}]$ contains $\sqrt{n}$ for $n$ a squarefree integer.  Since $K$ has the basis $\{1, \sqrt{m}\}$, so $\sqrt{n} = p + q\sqrt{m}$ for $p, q \in \mathbb{Q}$. Therefore $n = p^2 + 2pq\sqrt{m} + q^2m$, so either $p = 0$ or $q = 0$.

If $p = 0$, then $\sqrt{n} = q\sqrt{m}$ and so $\sqrt{n} / \sqrt{m} = q$.  This can only happen if $q = 1$, meaning $m = n$.

If $q = 0$, then $\sqrt{n} = p$, which can only happen if $p$ is also an integer, contradicting $n$ squarefree.

Therefore the quadratic fields are each distinct.

\item[2.]
    Let $I$ be the ideal generated by $2$ and $1 + \sqrt{-3}$ in the ring $\mathbb{Z}[\sqrt{-3}]$.

    We have $I \neq (2)$ because $1 + \sqrt{-3}$ ($\in I$) does not have the form $2a + b\sqrt{-3}$ for $a, b \in \mathbb{Z}$.  The ideal $I^2$ is generated by $(4, 2 + 2\sqrt{-3}, -2 + 2\sqrt{-3})$.  The number $-2 + 2\sqrt{-3} = 2 + 2\sqrt{-3} - 4$ and so is redundant as a generator; therefore $I^2 = (4, 2 + 2\sqrt{-3}) = 2I$.

    Since $I^2 = 2I$, prime factorization of ideals in $\mathbb{Z}[\sqrt{-3}]$ must not hold; if we did then $I$ would be invertible, meaning it could be cancelled from the right-hand-side of each equality, giving us $I = (2)$ which is not true (from above).

    Suppose $P$ is a prime ideal of $\mathbb{Z}[\sqrt{-3}]$ containing $2$.  Then $4 \in P$ also.  Since $(1 + \sqrt{-3})(1 - \sqrt{-3}) = 4$ and $P$ is a prime ideal, one of $1 + \sqrt{-3}$ and $1 - \sqrt{-3}$ are also in $P$.  However, if $1 - \sqrt{-3} \in P$ then $1 + \sqrt{-3} \in P$ since $-1 \cdot (1 - \sqrt{-3}) + 2 = 1 + \sqrt{-3}$.  Therefore any prime ideal containing $(2)$ also contains $I$ and $I$ is the unique prime ideal that contains $(2)$.  Since $I$ cannot be expressed as a product of prime ideals, neither can $(2)$.

    (We should expect this; $\mathbb{Z}[\sqrt{-3}]$ is an order of conductor $2$ in $\mathbb{Z}[\frac{1 + \sqrt{-3}}{2}]$ and $I$ is not prime to the conductor, meaning it is not invertible.)

\item[3.]
    Complete the proof of Corollary 2, Theorem 1.

    The statement of the text leaves off with $\alpha$ being an algebraic integer if and only if $2r$ and $r^2 - ms^2$ are both integers, where $r, s \in \mathbb{Q}$.

    $2r$ being an integer requires that $r = \frac{a}{2}$, where $a$ is an integer.  Substituting $r = \frac{a}{2}$ into the second equation, we see that $a^2 - 4ms^2$ is an integer divisible by $4$.  In order for the quantity to be an integer, $s = \frac{b}{2}$, where $b$ is an integer.  Therefore $\alpha$ is an algebraic integer of the form $\frac{a + b\sqrt{m}}{2}$ if and only if $a^2 - mb^2 = 0 \mod 4$.

    We finish by considering $m \mod 4$ and seeing under which statements the given equation is solvable.  The key is that integer squares are either equivalent to 0 or 1 modulo 4.
    \begin{itemize}
        \item {\bf $\modequiv{m}{1}{4}$}:  Let $a$ be even - then $a^2 \equiv 0 \mod 4$, and to satisfy the equality, $b^2 \equiv 0 \mod 4$ and so $b$ must also be even.  Similarly, if $a$ is odd, then $a^2 \equiv 1 \mod 4$ - to satisfy the equality, $b$ must also be odd.  Therefore $\alpha = \frac{a + b\sqrt{m}}{2}$ for all $a \equiv b\ (2)$ as required.
        \item {\bf $m \equiv 2, 3 \mod 4$}: For the equation to be solvable, both $a$ and $b$ must be equivalent to 0 or 2 modulo 4 (and so even), meaning $\alpha = c + d\sqrt{m}$ for $c, d \in \mathbb{Z}$ as required.
    \end{itemize}

\item[4.]
    Suppose $a_0, \ldots, a_{n_1}$ are algebraic integers and $\alpha$ is a complex number satisfiying $\alpha^n + a_{n-1}\alpha^{n-1} + \cdots + a_1\alpha + a_0 = 0$.  Show the ring $\mathbb{Z}{[a_0, \ldots, a_{n-1}, \alpha]}$ has a finitely generated additive group.

    For each $a_i$ let $k_i$ be the degree of the algebraic integer $a_i$ over $\mathbb{Q}$: therefore for any power $k >= k_i$, it can be written as a linear combination of powers of $a_i$ less than $k_i$.  Additionally any power of $\alpha^k$ where $k \ge n$ can be written as a linear combination of powers of $\alpha$ multiplied by each of the $a_i$.  Therefore only a finite number of powers of $a_0^{m_0} \cdots a_n^{m_n} \alpha^{m}$ are needed; the $a_i$ terms are capped to be lower than $k_i$ and the $\alpha$ term is capped to be lower than $n$.

    Since $\alpha$ is a member of a subring of $\mathbb{C}$ that is finitely generated, $\alpha$ is therefore an algebraic integer.

\item[5.]
    Let $f$ be a polynomial over $\mathbb{Z}_p$ where $p$ is a prime.  We prove $f(x^p) = (f(x))^p$ by induction on number of terms.

    If $f(x) = kx^{b}$ where $k \in \mathbb{Z}_p$, then $f(x^p) = kx^{pb} = k^p x^{bp} = (kx^{b})^p$ (since $k^p = k$ for all $k \in \mathbb{Z}_p$).

    Next, let $f(x) = g(x) + h(x)$ where $g(x)$ and $h(x)$ have fewer terms than $f(x)$.
    \begin{eqnarray*}
        f(x)^p          &=& (g(x) + h(x))^p \\
                        &=& g(x)^p + h(x)^p + \sum_{k = 1} \binom{p}{k} g(x)^{k} h(x)^{p - k} \\
                        &=& g(x)^p + h(x)^p \\
                        &=& g(x^p) + h(x^p) \text{ (using the inductive hypothesis)}\\
                        &=& f(x^p)
    \end{eqnarray*}
    This is the required result.

\item[6.] If $f$ and $g$ are polynomials over a field $K$ and $f^2 \mid g$, then $g = f^2 h$.  Therefore $g' = f^2 h' + 2 h f f'$, so $f \mid g'$.

\item[7.] Complete the proof of Corollary 2, Theorem 3.

Let $\phi_{k}$ be the automorphism of $\mathbb{Q}[\omega]$ sending $\omega$ to $\omega^k$.  Then $(\phi_{a} \circ \phi_{b}) (\omega) = (\omega^{a})^{b} = \omega^{ab} = \phi_{ab}$, giving the required result that composition of automorphisms corresponds to multiplication modulo $m$.

\item[8. (a)] Let $\w = e^{2\pi i/p}$ where $p$ is an odd prime.
Then \[ \text{disc}(\w) = \prod_{1 \le r < s \le n} (\alpha_r - \alpha_s)^2 = \pm p^{p - 2} \]
Therefore \[ \Big\lvert \prod_{1 \le r < s \le n} (\alpha_r - \alpha_s)\ \Big\rvert = \sqrt{\pm p^{p - 2}} = p^{(p - 3) / 2} \sqrt{\pm p} \]

Let $\z = e^{2\pi i /3}$.  Using the above we have the identity $(\z - \z^2) = \sqrt{-3}$.

Let $\z = e^{2\pi i / 5}$.  Note $\z^4 = -(\z^3 + \z^2 + \z + 1)$.

We expand the product: \[ (\z - \z^2)(\z - \z^3)(\z - z^4)(\z^2 - \z^3)(\z^2 - \z^4)(\z^3 - \z_4) = 10\z^3 + 10\z^2 + 1 \]

Observing that this product is negative we flip the signs and divide by $5^{(5 - 3)/2} = 5$ to get the identity $\sqrt{5} = -2\z^3 - 2\z^2 - 1$.

\item[8. (b)] The 8th cyclotomic polynomial is $x^4 + 1$, so the 8th cyclotomic field contains all the roots of this equation, which includes $\sqrt{i} = (1/\sqrt{2})(1 + i)$ and its complex conjugate $(1/\sqrt{2})(1 - i)$.  Thus the 8th cyclotomic field also contains their sum $2 / \sqrt{2} = \sqrt{2}$.

\item[8. (c)] Let $m$ be a squarefree number.  Then $m$ can be written as $2^{i} q$ where $2 \nmid q$, and $i \in \{0, 1\}$.  We proceed by case analysis, showing for each that $\sqrt{m}$ is contained in the $d$th cyclotomic field, where $d = \text{disc}(\mathbb{A} \cap \mathbb{Q}[\sqrt{m}])$.

$m = -1$: $\sqrt{-1}$ is contained in the 4th cyclotomic field which contains the complex unit $i$ ($d = -4$).

$m = 2$: $\sqrt{2}$ is contained in the 8th cyclotomic field by part (b) ($d = 4\cdot 2 = 8$).

$m = -2$: The 8th cyclotomic field contains $i$ (since it contains the 4th cyclotomic field as a subfield) so it contains $\sqrt{-2} = i\sqrt{2}$ ($d = 4\cdot -2 = -8$).

$m = q$ where $q \equiv 1 \mod 4$: Because $q \equiv 1 \mod 4$, $q$ has an even number of prime factors $\equiv 3 \mod 4$, meaning that $\sqrt{q}$ must be contained in the $q$-th cyclotomic field ($d = q$ since $q\equiv 1\mod 4$).

$m = q$ where $q \equiv 3 \mod 4$: The $4q$-th cyclotomic field contains the $q$-th cyclotomic field (containing $\sqrt{-q}$) and the 4th cyclotomic field (containing $\sqrt{-1}$) ($d = 4q$ since $q \equiv 3 \mod 4$), and so contains $\sqrt{q}$.

$m = 2q$ where $q$ is a product of odd primes:  Here $d = 8q$.  By the above, $\sqrt{q}$ is contained in either the $q$-th or $4q$-th cyclotomic field, depending on its residue mod 4.  Thus $\sqrt{2q}$ is contained in the $8q$-th cyclotomic field.

This shows every quadratic field $\mathbb{Q}[\sqrt{m}]$ is contained within the $d$-th cyclotomic field.

\item[9.] Let $\theta$ be a primitive $k$-th root of unity, i.e. $\theta = e^{2\pi i / k}$.  Let $\text{gcd}(k, m) = d$.  Using Euclid's extended algorithm we can find $u, v$ such that $uk + vm = d$.  Then we have
\[ \w^u \theta^v = e^{(2\pi i u)/m} e^{(2\pi i v) / k} = e^{2\pi i (uk + vm) / km} = e^{2\pi i d / km} = e^{2\pi i / r} \]
where $r = \text{lcm}(k, m)$ ($\text{lcm}(k, m) = km / \text{gcd}(k, m)$).

\item[10.] Show if $m$ is even, $m \mid r$, and $\phi(r) \le \phi(m)$ then $r = m$.

If $m \mid r$ there is some $k$ such that $mk = r$.  Let $d = \gcd(k, m)$, so $r = mdj$ with $j$ satisfiying $\gcd(j, m) = 1$.  Therefore $\phi(r) = \phi(md)\phi(j)$.  Since $d \mid m$, $\phi(md) = d \cdot \phi(m)$, so \[ \phi(r) = d \cdot \phi(m)\phi(j) \le \phi(m) \]  The inequality forces $d = 1$ and $\phi(j) = 1$.  Because $2 \mid m \mid r$, $\phi(j) = 1$ implies $j = 1$.  Therefore $m = r$.

\item[11. (a)] Suppose all the roots to a monic polynomial $f$ have absolute value $1$.  Show that the coefficient of $x^r$ has absolute value $\le \binom{n}{r}$, where $n$ is the degree of $f$ and $\binom{n}{r}$ is the binomial coefficient.

Factor $f$ as $f = (x - \alpha_0) \cdots (x - \alpha_n)$.  Re-expanding $f$ we see that the coefficient of $x^r$ is equal to $\sum_{S \subseteq \{0, \ldots, n\}, |S| = r} x^r \prod_{i \in S} \alpha_i$.  By assumption $|\alpha_i| = 1$ for all $i$, so $|\prod_{i \in S} \alpha_i| = 1$.  There are $\binom{n}{r}$ of these subsets of $S$.

Using the identity $|a + b| \le |a| + |b|$ we have:
\begin{eqnarray*}
    \left|\sum_{S \subseteq \{0, \ldots, n\}, |S| = r} \prod_{i \in S} \alpha_i \right| &\le& \sum_{S \subseteq \{0, \ldots, n\}, |S| = r} | \prod_{i \in S} \alpha_i | \\
    &\le& \sum_{S \subseteq \{0, \ldots, n\}, |S| = r} 1 \\
    &\le& \binom{n}{r}
\end{eqnarray*}

\item[11. (b)] We will consider all monic polynomials $f$ of degree $n$ and show that only a finite number of them can have a root $\alpha$ all of whose conjugates have absolute value 1.

By Theorem 1, if $\alpha$ is an algebraic integer, than the coefficients of $f$ are integers.  By (b), the absolute value of the coefficients of $f$ are bounded above $\binom{n}{r}$, therefore there are at most $2\binom{n}{r}$ choices for each coefficient beyond the $x^n$th term.  The constant term of the polynomial must be 1 (since $\alpha$ has absolute value 1) and the first term of the polynomial must also be 1 (since $f$ is monic). This gives an upper bound of $\sum_{r=1}^{n - 1} 2\binom{n}{r} = 2(2^n - 2) = 4(2^{n-1} - 1)$ on the number of algebraic integers satisfying the given condition.

\item[11. (c)]{(TODO)}

\item[12. (a)] Let $u$ be a unit in $\Z[\w]$, where $\w = e^{2\pi i / p}$.  Show $u / \overline{u}$ is a root of 1.

The field $\Q[\w]$ has Galois group $\simeq \Z_p^{\times}$, which has cardinality $p - 1$ and so has an element of order 2 (complex conjugation).  Therefore $u$ has $p - 1$ conjugates, which consist of $(p - 1) / 2$ elements along with their complex conjugates.  Enumerate the conjugates of $u$ as $a_1, \ldots, a_n, \overline{a_1}, \ldots, \overline{a_n}$.

Therefore, the conjugates of $u / \overline{u}$ have the form $a_i / \overline{a_i}$ or $\overline{a_i} / a_i$.  Multiplying over all conjugates of $u / \overline{u}$, we have $\prod_{i = 0}^{n} a_i / \overline{a_i} \cdot \prod_{i = 0}^{n} \overline{a_i} / a_i = 1$, and so $u / \overline{u}$ and all its conjugates have absolute value 1.  By 11 (c), $u / \overline{u}$ is then a root of 1, and so has form $\pm \omega^{k}$.

\item[12. (b)] Suppose $u / \overline{u} = -\omega^{k}$.  We derive a contradiction.  Raising both sides to the $p$-th power we have $u^p / \overline{u^p} = -(\omega^{k})^p = -(\omega^{p})^k = -1$, and so $u^p = -\overline{u^p}$.  By exercise 1.25, $u^p \equiv a\ (p)$ for some $a \in \Z$.  Applying exercise 1.23, we see $\overline{u^p} \equiv \overline{a} = a\ (p)$, and so $a \equiv -a\ (p)$.  There $a$ must be 0, and $u^p \equiv 0\ (p)$, so $p$ divides $u^p$.  This contradicts $u^p$ being a unit, since if $p$ divided $u^p$, p would also divide the absolute value of $u^p$, which is 1.  Therefore $u / \overline{u} = \omega^{k}$.

\item[13.] Show that 1 and -1 are the only units in the ring $A \cap \Q[\sqrt{m}]$, $m$ squarefree and $m < 0, m \neq -1, -3$.  What if $m = -1, -3$?

Let $u$ be a unit in $A \cap \Q[\sqrt{m}]$.  Then $u = a + b\sqrt{m}$ where $p, q \in A \cap \Q[sqrt{m}]$. Since $N(u) = 1$, then $(a + b\sqrt{m})(a - b\sqrt{m}) = a^2 - b^2 m = 1$.  We proceed by cases on whether $\modequiv{m}{1}{4}$.

If $m \not\equiv 1 \mod 4$, then $a$ and $b$ must be integers and so $a^2 - b^2 m = 1$ can only be satisfied if one of the terms is 1 and the other is 0.  If $a^2 = 1$, then $b^2 m = 0$.  This corresponds to the units 1 and -1 in $A \cap \Q[\sqrt{m}]$.  If $-b^2 m = 1$, then $b^2 m = -1$ and so $m = -1$.  This corresponds to the units $i$ and $-i$ in $A \cap \Q[\sqrt{-1}]$.

If $\modequiv{m}{1}{4}$ then let $a = r / 2$ and $b = s / 2$.  Therefore $r^2 - s^2 m = 4$.  Since $m$ is negative, both $r^2$ and $-s^2 m$ must be positive.  $r^2$ must be either $0$, $1$, or $4$.

If $r^2$ is 0 then $-s^2 m = 4$, so $s^2 m = -4$, forcing $m = -1$ which is not $\equiv \mod 4$.  (We have considered this case already.)

If $r^2$ is 1 then $-s^2 m = 3$ so $s^2 m = -3$ and $m = -3$, $s = \pm 1$.  This corresponds to the unit $\pm \frac{1}{2} \pm \frac{\sqrt{-3}}{2}$ in the ring $A \cap \Q[\sqrt{-3}]$.

If $r^2$ is 4 then $- s^2 m = 0$, which corresponds to the unit $\pm 1$ in the ring $A \cap \Q[\sqrt{m}]$.

\item[14.] Show that $1 + \sqrt{2}$ is a unit in $\mathbb{Z}[\sqrt{2}]$, but not a root of 1.

$1 + \sqrt{2}$ is a unit, as $-(1 - \sqrt{2})$ is its inverse: \[ -(1 + \sqrt{2})(1 - \sqrt{2}) = -1 + (\sqrt{2})^2 = 1 \]

If $1 + \sqrt{2}$ were a root of 1, we would have $(1 + \sqrt{2})^k = 1$ for some $k$.  However by the Binomial Theorem, $(1 + \sqrt{2})^k = \sum^{k}_{i = 0} \binom{k}{i} (\sqrt{2})^i$, which will always contains a term $\sqrt{2}$ multiplied by a positive number.  Therefore $1 + \sqrt{2}$ is not a root of 1.

Let $(1 + \sqrt{2})^k = a + b\sqrt{2}$.  The inverse of this term is \[((1 + \sqrt{2})^k)^{-1} = ((1 + \sqrt{2})^{-1})^{k} = (-1)^k (1 - \sqrt{2})^k = (-1)^k (a - b\sqrt{2})^k \]

Therefore, $(a + b\sqrt{2})^k \cdot (a - b\sqrt{2})^k = \pm 1$ and so the powers of $1 + \sqrt{2}$ give an infinite number of $a$, $b$ such that $a^2 - 2b^2 = \pm 1$.

\item[15. (a)] Let $a + b\sqrt{-5}$ be an element of $\zquad{-5}$.  Then the norm of $a + b\sqrt{-5}$ is $(a + b\sqrt{-5})(a - b\sqrt{-5}) = a^2 + 5b^2$, where $a, b \in \mathbb{Z}$.  Since there are no integer solutions $a, b$ such that $a^2 + 5b^2 = 2$ or $a^2 + 5b^2 = 3$, there can be no element of $\zquad{-5}$ with a norm of $2$ or $3$.
\item[15. (b)] In $\zquad{-5}$, $6 = 2 \cdot 3 = (1 + \sqrt{-5})(1 - \sqrt{-5})$.  If unique factorization held in $\zquad{-5}$, there would be elements $a, b, c, d \in \zquad{-5}$ such that $a \cdot b = 2$, $c \cdot d = 3$, $a \cdot d  =  1 + \sqrt{-5}$, $b \cdot c = 1 - \sqrt{-5}$.
    However by (a), 2 and 3 are irreducible in $\zquad{-5}$, meaning they are irreducible elements, and so no $a, b, c, d$ can exist.

\item[16.]
We argue in the style of K. Conrad: Trace and Norm, Section 4.  Suppose $\sqrt{3} \in \qext{\alpha}$ where $\alpha = \sqrt[4]{2}$; therefore $\sqrt{3} = a + b\alpha + c\alpha^2 + d\alpha^3$.  We have the following traces:
\begin{eqnarray*}
    \trace{\sqrt{3}} &=& \sqrt{3} - \sqrt{3} = 0 \\
    \trace{\alpha} &=& \alpha - \alpha + i\alpha - i\alpha = 0\\
    \trace{\alpha^2} &=& \alpha^2 - \alpha^2 + i\alpha^2 - i\alpha^2 = 0\\
    \trace{\alpha^3} &=& \alpha^3 - \alpha^3 + i\alpha^3 - i\alpha^3 = 0\\
\end{eqnarray*}
Since $\sqrt{3} = a + b\alpha + c\alpha^2 + d\alpha^3$,
\begin{eqnarray*}
    \trace{\sqrt{3}} &=& \trace{a + b\alpha + c\alpha^2 + d\alpha^3} \\
    0 &=& a\trace{1} + b\trace{\alpha} + c\trace{\alpha^2} + d\trace{\alpha^3} \\
    0 &=& 4a \\
\end{eqnarray*}
Therefore $a = 0$, and we have $\sqrt{3} = b\alpha + c\alpha^2 + d\alpha^3$.  We have $\trace{\sqrt{3}\alpha} = \trace{\sqrt[4]{9/2}} = \sqrt[4]{9/2} - \sqrt[4]{9/2} + i\sqrt[4]{9/2} - i\sqrt[4]{9/2} = 0$, so $0 = b\trace{1} + c\trace{\alpha} + d\trace{\alpha}^2 = 4b$ and so $b = 0$.

Similarly $\trace{\sqrt{3}/\alpha^2} = \trace{\sqrt{3/2}} = 0$, and so $c = 0$.

From eliminating the coefficients $a, b, c$, we have $d\sqrt[4]{8} = \sqrt{3}$ and so $3 = d^2\sqrt{8} = 2d^2\sqrt{2}$.  Therefore $\sqrt{2}$ is expressible as a rational number $3/d^2$, a contradiction.  Therefore $\sqrt{3} \not\in \qext{\alpha}$.

(Where would this argument break down for $\sqrt{2}$?  $\sqrt{2} = \alpha^2$ so $\sqrt{2} / \alpha^2 = 1$ and so we would conclude that $c = 1$ rather than $c = 0$.)

\item[17 - TODO]

\item[18 - TODO]

\item[19 - TODO]

\item[20.] Write $f(x) = (x - \alpha)g(x)$.  By the chain rule $f'(x) = (x - \alpha)g'(x) + g(x)$, so $f'(\alpha) = g(\alpha) = \prod_{\beta \neq \alpha} (\alpha - \beta)$.

\item[21.] Let $f(x) = g(x) h(x)$, where $g(x)$ is the minimum polynomial of $\alpha$ over $\mathbb{Z}$.  Then $f'(x) = g'(x)h(x) + g(x) h'(x)$ and $f'(\alpha) = g'(\alpha)h(\alpha)$.  We have \[ \norm{f'(\alpha)} = \norm{g'(\alpha)}\norm{h(\alpha)} \].  By Theorem 8, $\norm{g'(\alpha)} = \pm \disc{\alpha}$, so \[ \norm{f'(\alpha)} = \pm \disc{\alpha}\norm{h(\alpha)} \]
Therefore $\disc{\alpha}$ divides $\norm{f'(\alpha)}$ as required.

\item[23. (c)] Let $\{ \alpha_1, \ldots, \alpha_n \}$ be an integral basis for $K$ ($n = [K : \Q$) and let $\{ \beta_1, \ldots, \beta_m \}$ be an integral basis for $L$ ($m = [L : \Q]$).  Therefore \[ \{ \alpha_i \beta_j \ |\ 1 \le i \le n, 1 \le j \le m \] is an integral basis for $KL$.

We have the tower of field extensions $KL : K : \Q$ where $[KL : K] = m$, $[K : \Q] = n$.  By the formula established in (b), \[ \disc{\alpha_i \beta_j} = (\disc{\alpha_i})^m N^{K}_{\Q} \disc{\beta_j} = (\text{disc}\ R)^m (\text{disc}\ S)^n \]
Because $\text{disc}\ S$ is an integer, its norm is the degree of $K$ over $\Q$.

\item[24]  Let $G$ be a free abelian group of rank $n$ and let $H$ be a subgroup.  Take $G = \Z \oplus \cdots \oplus \Z$.  We show by induction that $H$ is a free abelian group of rank $\leq n$.

{\bf First prove the result for $n = 1$.}

If $G$ is a free abelian group of rank 1, $G = \Z$.  If $H$ is a subgroup of $G$ then $H$ must have a least non-negative element, call it $m$.  Then $H$ is generated by $m$ (all subgroups of $\Z$ are generated by a single element).

Next, we assume the result holds for $n - 1$, and define $\pi : G \to \Z$ the projection of $G$ onto the first factor.  Let $K$ denote the kernel of $\pi$.

{\bf (a): Show that $H \cap K$ is a free abelian group of rank $\le n - 1$.}

Let $\iota$ be the map that drops the first factor from $G$; as $K$ is a subgroup of $G$, then $\iota(H \cap K)$ must be a subgroup of $\iota(G)$.  $\iota(G)$ is a free abelian group of rank $n - 1$, and so applying the inductive hypothesis, we see $\iota(H \cap K)$ = $0 \oplus (H \cap K)$ is a free abelian group of order $n -1$.

{\bf (b): The image $\pi(H) \subset \Z$ is either $\{0\}$ or infinite cyclic.  If it is 0, then $H = H \cap K$.  Otherwise let $h \in \pi(H)$ be a generator of $\pi(H)$.  Show $H$ is the direct sum of its subgroups $\Z h$ and $K \cap H$.}

Let $h$ be as in the problem statement.  Let $a \in H$.  We will show $a$ is a member of $\Z h \oplus (K \cap H)$.  If $\pi(a) = 0$, then $a \in H \cap K$ and so $a$ is a member of the required group.  Otherwise $\pi(a) = m\pi(h)$ for some integer $m$ and so $mh - a \in K \cap H$ (a free abelian group of rank $\le n - 1$).  Therefore $a$ is the direct sum of $mh \in \Z h$ and the components of $mh - a$.  Since $a$ was chosen arbitrarily, $H = \Z h \oplus (K \cap H)$.

\item[25.] Let $\alpha$ be an algebraic number, so there is some $f \in \Q[x]$ such that $f(\alpha) = 0$.  We convert this polynomial into a (non-monic) $g \in \Z[x]$ by through multiplying by the GCD $m$ for all of the denominators in the coefficients of $f$.  Then $g = a_n x^n + a_{n-1} x^{n-1} + \cdots + a_0$ and $g(\alpha) = 0$.  Multiplying through by $a_n ^ {n - 1}$ gives the relationship $(a_n \alpha)^n + a_{n-1} a_n^{n- 1} \alpha^{n - 1} + \cdots + a_n^{n-1} a_0 = 0$.  This is a monic polynomial with integer coefficients, so $m a_n^{n} \alpha$ is an algebraic integer.

Given any finite set of algebraic numbers, $\{\alpha_0, \ldots \alpha_n \}$ let $m_i$ be such that $m_i \alpha_i$ is an algebraic integer.  Therefore taking $M$ to be the least common multiple of each $m_i$ gives us a number $M$ such that each $M\alpha_i$ is an algebraic integer.

\item[26.] The proof that two sets that generate the same subgroup have the same discriminant is the same as that of Theorem 11: as $\{\beta_1, \ldots, \beta_n\}$ and $\gamma_1, \ldots, \gamma_n\}$ generate the same additive subgroup, we can write the $\gamma_i$ in terms of the $\beta_i$ through an matrix $M$ with entries in $\Z$, and vice versa.  This shows that the translate matrices must have determinant 1, so the discriminants are equal.

\item[27.] Let $G$ and $H$ be two free abelian subgroups of rank $n$ in $K$, with $H \subset G$.
\item[27. (a)] Show $G / H$ is a finite group.

Since $G$ and $H$ are free abelian subgroups of rank $n$, $G \simeq \Z \oplus \cdots \oplus \Z$ and since $H$ is a subgroup of $G$, then $H \simeq I_1 \oplus \cdots \oplus I_n$, where each $I_i \subseteq \Z$ is an additive subgroup of $\Z$.  Each $\Z / I_i$ is finite, having cardinality equal to the generating element of $I_i$.  Therefore $G/H$ is finite, having cardinality $\prod_{i = 0}^{n} |\Z/I_i|$.

\item[27. (b)]  The well-known finite structure theorem for abelian groups says $G / H$ is a direct sum of at most $n$ cyclic groups.  Use this to show that $G$ has a generating set $\beta_1, \ldots, \beta_n$ such that for appropriate integers $d_i$, $d_1\beta_1, \ldots, d_n\beta_n$ is a generating set for $H$.

Let $\beta_i$ be 1 projected to the $i$th-factor and 0 elsewhere.  Then the set of $\{\beta_i\}$ generate $G$.  Let $d_i$ be the minimum element of $I_i$, an additive subgroup of $\Z$: we show $\{d_i\beta_i\}$ generates $H$.  Take $a \in H$, and let $\iota_i(a)$ be the $i$th factor of $a$, so $\iota_i(a) \in I_i$.  By choice of $d_i$, $\iota_i(a) = d_i m$ for some integer $m$, and $a = \iota_1(a) \oplus \cdots \oplus \iota_n(a) = d_1 \beta_1 + \cdots + d_n \beta_n$.  Since $a$ was chosen arbitrarily, the $\{d_i\beta_i\}$ generates $H$.

\item[27. (c)]  $\disc{H} = \disc{d_1\beta_1, \ldots, d_n\beta_n}$: by Exercise 3.18 (a), \[\disc{H} = (d_1 \cdots d_n)^2 \disc{\beta_1, \ldots, \beta_n} = |G/H|^2 \disc{G} \]

\item[27. (d)] Show that if $\alpha_1, \ldots, \alpha_n \in R = \ringofintegers{K}$, then they form an integral basis iff $\disc{\alpha_1, \ldots, \alpha_n} = \disc{R}$.

Let $H$ be the additive subgroup formed by $\alpha_1, \ldots, \alpha_n$.  By (c), we have $\disc{H} = |R/H|^2 \disc{R}$.  Therefore $\disc{R} = \disc{G}$ iff $|G/H|^2 = 1$, which is the same as saying that there is $b \in G$ such that $b \not\in H$.  Therefore $\disc{\alpha_1, \ldots, \alpha_n} = \disc{R}$ if and only if they form an integral basis for $R$.

\item[27. (e)] Show that if $\alpha_1, \ldots, \alpha_n \in R = \ringofintegers{K}$ and $\disc{\alpha_1, \ldots, \alpha_n}$ is squarefree, then the $\alpha_i$ form an integral basis for $R$.

If $\disc{H}$ is squarefree then $|R / H| = 1$ which implies that $\disc{H} = \disc{R}$.  By (d) the $\alpha_i$ form an integral basis for $R$.

\item [28. (a)] Taking the derivative of the polynomial, we have $f'(x) = 3x^2 + a$.  We then have:
\begin{eqnarray*}
    f'(\alpha) &=& 3\alpha^2 + a \\
    \alpha f'(\alpha) &=& 3\alpha^3 + a\alpha \\
    \alpha f'(\alpha) &=& -3(a\alpha + b) + a\alpha \\
    \alpha f'(\alpha) &=& -2a\alpha - 3b \\
    f'(\alpha) &=& -(2a\alpha + 3b) / \alpha \\
\end{eqnarray*}

\item [28. (b)] It is straightforward that $2a\alpha + 3b$ is a root of the polynomial $g(x) = (\frac{x - 3b}{2a})^3 + a(\frac{x - 3b}{2a}) + b$.  To calculate the norm of $2a\alpha + 3b$ over $\Q[\alpha]$, we thus divide the zero coefficient of $g(x)$ by negative the initial coefficient of $g(x)$ (negative since $n = 3$ is odd):
\[ -(2a)^3\left(\frac{(-3b)^3}{(2a)^3} - \frac{3b}{2} + b\right) \]
Reducing terms gives us
\[ \norm{2a\alpha + 3b} = (3b)^3 + (2^2)a^3b = 27b^3 + 4a^3b \]

\item[28. (c)] By Theorem 8, $\disc{a} = -\norm{f'(\alpha)}$ (the negative sign holds since $n = 3 \not\equiv 0,1 \ (4)$, ).

Note that given the factoring of $f(x)$ into $(x - \alpha_1)(x - \alpha_2)(x - \alpha_3)$, $(-1)\alpha_1\alpha_2\alpha_3 = -\norm{\alpha} = b$, $\norm{\alpha} = -b$.

We now compute the discriminant of $\alpha$:
\begin{eqnarray*}
    \disc{\alpha} &=& -\norm{f'(\alpha)} \\
                    &=& -\norm{-(2a\alpha + 3b)/\alpha} \\
                    &=& \frac{27b^3 + 4a^3b}{-b} \\
                    &=& -(27b^2 + 4a^3)
\end{eqnarray*}
This is the required result.

\item[28. (d)] If $\alpha^3 = \alpha + 1$, then $a = -1$ and $b = -1$.  By (c), $\disc{\alpha} = -27 - 4 = -31$, which is squarefree.  By 27 (c) the powers of $\alpha$ thus form an integral basis for $\mathbb{A} \cap \Q[\alpha]$.

Similarly if $a = 1$ and $b = -1$, then $\disc{\alpha} = -27 + 4 = -23$ (squarefree) and so again by 27 (c) the powers of $\alpha$ form an integral basis for $\mathbb{A} \cap \Q[\alpha]$.

\item[29.] Let $\Q[\sqrt{m}, \sqrt{n}]$, where $(m, n) = 1$.  Find an integral basis and the discriminant of this basis for (a): the case where $m, n \equiv 1\ (4)$ and (b) where $m \equiv 1\ (4)$, $n \not\equiv 1\ (4)$.

For both given scenarios, the ring of integers is a linear combination of the ring of integers of $\Q[\sqrt{m}]$ and $\Q[\sqrt{n}]$, and so Theorem 12, Corollary 1 applies, and an integral basis can be found as a combination of the bases of the individual rings.

\item [29. (a)] $m, n \equiv 1\ (4)$: The corresponding rings of integers for $\Q[\sqrt{m}]$ and $\Q[\sqrt{n}]$ are $\Z[(1 + \sqrt{m})/2]$ and $\Z[(1 + \sqrt{n})/2)]$ with discriminants $m$ and $n$.  By assumption, these discriminants are relatively prime, so Theorem 12, Corollary 1 applies.  The field $\Q[\sqrt{m}, \sqrt{n}]$ thus has an integral basis $\{ 1, (\sqrt{m} + 1)/2, (\sqrt{n} + 1)/2, (1 + \sqrt{m} + \sqrt{n} + \sqrt{nm})/4 \}$.  By Exercise 23 (c), the discriminant for this basis is $m^2 n^2$ .

\item [29. (b)] The rings of integers for $\Q[\sqrt{m}]$ and $\Q[\sqrt{n}]$ are $\Z[(1 +\sqrt{m})/2]$ and $\Z[\sqrt{n}]$, with discriminants $m$ and $4n$.  Since $m$ was assumed to be squarefree, $(m, 4n) = 1$, so Theorem 12, Corollary 1 applies again.  The field $\Q[\sqrt{m}, \sqrt{n}]$ thus has an integral basis $\{ 1, (\sqrt{m} + 1)/2, \sqrt{n}, (\sqrt{mn} + \sqrt{n})/2 \}$.  By Exercise 23 (c), the discriminant for this basis is $m^2 (4n)^2 = 16m^2 n^2$.

\item[30.] Let $f$ be the monic irreducible polynomial for $\alpha$ over $\Z$ and for each $g \in \Z[x]$, let $\overline{g}$ denote the polynomial in $\Z_3[x]$ obtained by reducing the coefficients mod 3.

\item[30. (a)] Show that $g(\alpha)$ is divisible by 3 in $\Z[\alpha]$ if and only if $\overline{g}$ is divisible by $\overline{f}$ in $\Z_3[x]$.

Suppose $g(\alpha)$ is divisible by 3.  Then $g(\alpha) = 3m$ for some $m$ and so $(g - 3m)(\alpha) = 0$.  Since this is a polynomial in $\alpha$ and $f$ is the minimum polynomial, $f \mid g - 3m$.  Therefore $\overline{f} \mid \overline{g - 3m} = \overline{g}$.

If $\overline{g}$ is divisible by $\overline{f}$ in $\Z_3[x]$, then $\overline{g} = \overline{f}\overline{h}$ for some $h \in \Z[x]$, and so $g = (f + 3j)h$ in $\Z[x]$ for some poylnomial $j(x) \in \Z[x]$.  So $g(\alpha) = 3j(\alpha)h(\alpha)$ and $g(\alpha)$ is divisible by 3.

\item[30. (b)] Consider the four algebraic integers:
\begin{eqnarray*}
    \alpha_1 &=& (1 + \sqrt{7})(1 + \sqrt{10}) \\
    \alpha_2 &=& (1 + \sqrt{7})(1 - \sqrt{10}) \\
    \alpha_3 &=& (1 - \sqrt{7})(1 + \sqrt{10}) \\
    \alpha_4 &=& (1 - \sqrt{7})(1 - \sqrt{10}) \\
\end{eqnarray*}

The conjugates of each $\alpha_i$ are the other $\alpha_j$, and each product $\alpha_i \alpha_j$ is divisible by 3: $\alpha_1 \alpha_3$, $\alpha_2 \alpha_3$, $\alpha_1 \alpha_4$, and $\alpha_2 \alpha_4$ are divisible by $-6$, and $\alpha_1 \alpha_2$, $\alpha_1 \alpha_4$, $\alpha_2 \alpha_3$, and $\alpha_3 \alpha_4$ are divisible by $-9$.

We show that $\alpha_i^n / 3$ is not an algebraic integer by considering its trace: $\trace{\alpha_i^n / 3} = \trace{\alpha_i^n} / 3$, so we compute $\trace{\alpha_i^n}$.  The conjugates of $\alpha_i^n$ are each of the other $\alpha_j^n$, so $\trace{\alpha_i^n} = \alpha_1^n + \alpha_2^n + \alpha_3^n + \alpha_4^n$.  Modulo 3, $(\alpha_1 + \alpha_2 + \alpha_3 + \alpha_4)^n \equiv \alpha_1^n + \alpha_2^n + \alpha_3^n + \alpha_4^n$ because any of the monomials with any nonzero powers is divisible by 3 and so cancel out mod 3.  However $(\alpha_1 + \alpha_2 + \alpha_3 + \alpha_4)^n = 1^n = 1$.  Since each $\alpha_i$ is conjugate to each of the $\alpha_j$, their traces must be identical.

Therefore the trace of $\alpha_i^n$ is an integer $\equiv 1\ (3)$, and so $\trace{\alpha_i^n / 3}$ cannot be an integer, and so by Corollary 2 to Theorem 4, $\alpha_i^n / 3$ must not be an algebraic integer.

\item[30. (c)] Let $\alpha_i$ from (b) be defined by $f_i(\alpha)$ (for any fixed $\alpha$).  Because $\alpha_i \alpha_j$ is divisible by 3, by (a), $\overline{f} \divides \overline{f_i}\overline{f_j}$.  However, $\overline{f} \not \divides \overline{f_i}^n$ for any power of $n$ (or else 3 would $\overline{f_i}^n$ which is not the case by (b)), so $\overline{f_i}\overline{f_j} \ne \overline{f_i}^n$ for any $n$.  Therefore, since $\Z_3[x]$ is a UFD, $\overline{f}$ has an irreducible factor that does not divide $\overline{f_i}$ but does divide $\overline{f_j}$ for all $j \neq i$.

\item[30. (d)] The result of (c) is that $\overline{f}$ has at least 4 irreducible factors in $\Z_3[x]$.  However, $\overline{f}$ is of degree at most 4, since $\alpha \in \Q[\sqrt{7}, \sqrt{10}]$.  For there to be at least 4 irreducible factors of $\overline{f}$ it would imply each are of degree 1, but there are only 3 monic polynomials of degree 1 in $\Z_3[x]$: $x$, $x - 1$, $x - 2$.  Therefore $\mathbb{A} \cap \Q[\sqrt{7}, \sqrt{10}] \neq \Z[\alpha]$ for any $\alpha$.

\item[31.] Show that $\frac{\sqrt{3} + \sqrt{7}}{2}$ is an algebraic integer.

$\frac{\sqrt{3} + \sqrt{7}}{2}$ is the root of the degree 4 polynomial $f(x) = x^4 - 5x^2 + 1$.  This shows that the intersection of the ring of integers $\Z[\sqrt{3}]$ and $\Z[\sqrt{7}]$ is not $\Z[\sqrt{3}, \sqrt{7}]$; neither original ring contains fractional elements.  (Their discriminants are 12 and 28 respectively, sharing a factor of 4.)

\item[32.] The fields $\Q[\sqrt[3]{2}]$ and $\Q[\w\sqrt[3]{2}]$ where $\w = e^{2\pi i/3}$ both have degree 3 over $\Q$, but their composition $\Q[\w, \sqrt[3]{2}]$ has degree 6 over $\Q$.

\item[33.] Let $\w = e^{2\pi i / m}$, where $m \ge 3$.  We know that $N(\w) = \pm 1$ because $\w$ is a unit.  Show the $+$ sign holds.

Write $e^{2\pi i k /m}$ as $\w_k$.  The conjugates of $\w$ have the form $\w_k$ where $(k, m) = 1$.  There are $\phi(m)$ of these, which is even for all $m \ge 3$.  If $\w_k$ is a conjugate, then $\w_{m - k}$ is also a conjugate, since $(k, m) = 1$ implies there exist integers $a, b$ such that $ak + bm = 1$, so $-a(m - k) + (b + a)m = 1$, and so $(m - k, m) = 1$.

For each conjugate $\w_k$, $\w_k \ne \w_{m - k}$; if this were the case, $k = -k \ (m)$, so $2k = 0 \ (m)$ and so $k$ would divide $m$, contradicting $(k, m) = 1$.  Therefore all the conjugates are distinct.

Finally, for each conjugate $\w_{k}$, $\w_k \cdot \w_{m - k} = 1$, so in computing the norm of $\w$, all the conjugates cancel out and the norm of $\w$ is seen to be $1$.

\item[34. (a)] Show that $1 + \w + \w^2 + \ldots + \w^{k - 1}$ is a unit in $\Z[\w]$ if $k$ is relatively prime to $\w$.

\[ (1 + \w + w^2 + \ldots + \w^{k-1}) \left(\frac{1 - w}{1 - \w^k}\right) = \frac{1 - \w^k}{1 - \w^k} = 1 \]
Therefore, if $\frac{1 - w}{1 - \w^k} \in \Z[\w]$ then $1 + \w + \ldots + \w^{k-1}$ is a unit.  Since $(k, m) = 1$, then there exist $a, b \in \Z$ such that $ak + bm = 1$, and so $\w = \w^{ak + bm} = \w^{ak} \w^{bm} = \w^{ak}$.  Since $\w^{ak} = \w^{(m - a)k}$ for negative $a$, $a$ can be assumed to be positive.  We then have \[ \frac{1 - \w}{1 - \w^k} = \frac{1 - \w^{ak}}{1 - \w^{k}} = 1 + \w^{k} + \w^{2k} + \ldots + \w^{(a - 1)k} \in \Z[\w] \]
This implies $1 + \w + \w^2 + \ldots + \w^{k-1}$ is a unit in $\Z[\w]$.

\item[34. (b)] The conjugates of $1 - \w$ are $\w^{kp^{r-1}} - 1$ for $1 \le k \le p - 1$.  By (a), $1 - w^{k} = \frac{1 - \w}{1 + \w + \ldots + \w^{k}}$, so \[ \norm{1 - w} = (1 - \w)^{n}\left(\prod_{(j, p^r) = 1} \sum_{i = 0}^{j} \w^{i}\right)^{-1} \]
By (a) the sum of the $\w^{i}$ factors is a unit in $\Z[\w]$, so the inverse of the product of each of these is also a unit, call it $u$.  Therefore \[ \norm{1-w} = u(1 - w)^n\]  However as $f(x) = 1 + x^{p^{r-1}} + \ldots + x^{(p-1)p^{r-1}}$ is the $p^r$th cyclotomic polynomial, the norm of $1 - w$ is the constant coefficient of the polynomial $1 + (1 - x)^{p^{r-1}} + \ldots + (1 - x)^{(p - 1)p^{r-1}} = p$, and so $\norm{1 - w} = p$.  Setting both sides equal to one another gives $p = u(1 - \w)^n$.

\item[35. (a)]  Let $\w = e^{2\pi i /m}$ and $\theta = \w + \w^{-1}$.  Then $\w^2 - (\w + \w^{-1})(\w) + 1 = 0$ and so $\w$ is a root of the polynomial $x^2 + \theta x + 1$.  $\w \not\in \Q[\theta]$, therefore $\Q[\w] : \Q[\theta]$ has degree 2.

\item[35. (b)]  Since $\theta = \w + \w^{-1} \in \R$, clearly $\Q[\theta]  \subseteq \Q[\w] \cap \R$.  We therefore have the tower of field extensions $\Q[\theta] \subseteq \Q[\w] \cap \R \subsetneq \Q[\w]$.  By (a), $[\Q[w] : \Q[\theta]] = 2$.  By the Tower Law, $[\R \cap \Q[\w] : \Q[\theta]]$ must be a divisor of 2 by distinct from 2 (since $w \not\in \R)$.  Therefore the degree must be 1 and so $\R \cap \Q[\w] = \Q[\theta]$.

\item[35. (c)]  Let $\sigma$ be the automorphism defined by $\sigma(\w) = \w^{-1}$.  Then $\sigma(\theta) = \theta$, and so $\Q[\theta]$ is in the fixed field of the automorphism $\sigma$.  As the degree of $\Q[\w]$ over $\Q[\theta]$ is 2, there can be no distinct intermediate field between $\Q[\w]$ and $\Q[\theta]$.  $\Q[\w]$ is not in the fixed field of $\sigma$ and so $\Q[\theta]$ must be the fixed field of this automorphism.

\item[35. (d)]  Show that $\mathbb{A} \cap \Q[\theta] = \R \cap \Z[\theta]$.
\begin{align*}
    \mathbb{A} \cap \Q[\theta]
        &= \mathbb{A} \cap (\R \cap \Q[\w]) & \text{By 35 (b).}\\
        &= (\mathbb{A} \cap \Q[\w]) \cap \R & \text{By associativity of intersection}\\
        &= \Z[\w] \cap \R & \text{By Theorem 12, Corollary 2}
\end{align*}

This is the required result.

\item[35. (e)] Let $n = \phi(m) / 2$.  The set $\{ 1, \w, \w^2, \ldots, \w^{n-1}, \w^{n}, \w^{n+1}, \ldots, \w^{m-1} \}$ is an integral basis for $\Z[\w]$.

Since $w^{n-k} = \w^{-k}$, we can write this basis as $\{1, \w, \w^{-1}, \w^2, \w^{-2}, \ldots, \w^{-n}\}$ instead (note $\w^{n} = \w^{-n}$).  We examine the set $\{1, \w, \theta, \theta\w, \theta^2, \theta^2\w, \ldots, \theta^{n} \}$.

Now we pair up the expressions $\theta^{k}\w$ with $\w^{k+1}$ and $\theta^{k}$ with $\w^{-k}$:

\begin{gather}
\{1, \w, \w^{-1}, \w^2,     \w^{-2},  \w^{3},     \ldots, \w^{n} \} \\
\{1, \w, \theta,  \theta\w, \theta^2, \theta^2\w, \ldots, \theta^{n-1}\w \}
\end{gather}

We evaluate the expression $\theta^{k}$ using the Binomial Theorem:

\[ \theta^{k} = (\w + \w^{-1})^k = \sum_{i = 0}^{k} \binom{k}{i}\ \w^{i} \w^{-(k-i)} = \sum_{i = 0}^{k} \binom{k}{i}\ \w^{2i - k} \]

Therefore

\[ \theta^{k}\w = \sum_{i = 0}^{k} \binom{k}{i}\ \w^{2i - k + 1} \]

For $\theta^{k}$, the power of $\w$ ranges between $-k$ and $k$ for $\theta^{k}$, and it uses 1 term of the power $\w^{-k}$ and no power of $\w$ with absolute value greater than $k$.

For $\theta^{k}\w$, the power of ranges between $-k + 1$ and $k + 1$ for $\theta^{k}\w$.  It uses 1 power of $\w^{k}$ and no other power of $\w$ with absolute value of greater than or equal to $k$.

Therefore, there is a lower triangular translation matrix $A$ between the basis (1) and (2).  $A$ has all 1s in the diagonal, and so $A$ has determinant 1 and is invertible over $\Z$.  Since (1) is an integral basis of $\Z[\w]$, so is (2).

\[
    A\ =\hspace{5mm}
    \bordermatrix{
             & 1 & \w& \w^{-1} & \w^2 & \w^{-2} & \ldots \cr
    1        & 1 &  0  & 0 & 0 & 0 & \ldots \cr
    \w       &  0  & 1 & 0 & 0 & 0 & \ldots \cr
    \theta   &  0  & 1 & 1 & 0 & 0 & \ldots \cr
    \theta\w &  1  & 0 & 0 & 1 & 0 & \ldots \cr
    \theta^2 &  2  & 0 & 0 & 1 & 1 & \ldots \cr
    \vdots   & \vdots & \vdots & \vdots & \vdots & \vdots & \ddots & \cr
    }
\]

\item[35. (f)] Show that $\{ 1, \theta, \theta^2, \ldots, \theta^{n-1} \}$ is an integral basis for $\mathbb{A} \cap \Q[\theta]$.

By (d), $\mathbb{A} \cap \Q[\theta] = \R \cap \Z[\theta]$, and by (e), any member $\alpha$ of $\Z[\theta]$ is expressible in terms of the basis vectors $\{ 1, \w, \theta, \theta\w, \theta^2, \ldots \}$:
\[ \beta = a_0 + a_1 \w + a_2 \theta + a_3 \theta \w + \ldots + a_{m-1} \theta^{n-1} \]

Since $\beta \in \mathbb{R}$, $\sigma(\beta) = \beta$ (where $\sigma$ is complex conjugation).  Therefore:
\begin{eqnarray*}
\beta &=& \sigma(a_0 + a_1 \w + a_2 \theta + a_3 \theta\omega + \ldots + a_{m-1}\theta^{n-1})\\
    &=& \sigma(a_0) + \sigma(a_1 \w) + \sigma(a_2 \theta) + \sigma(a_3 \theta\omega) + \ldots + \sigma(a_{m-1}\theta^{n-1}) \\
    &=& a_0 + a_1 \sigma(\w) + a_2 \sigma(\theta) + a_3 \theta\sigma(\omega) + \ldots + a_{m-1}\theta^{n-1} \\
    &=& a_0 + a_1 \w^{-1}+ a_2 \theta + a_3 \theta\sigma(\omega) + \ldots + a_{m-1}\theta^{n-1}
\end{eqnarray*}
Since the elements of basis are linearly independent, each odd $a_{i}$ must be equal to 0, and so $\beta$ must be expressible as $a_0 + a_2\theta + \ldots + a_{m-1}\theta^{n-1}$, and so $\Q[\theta]$ is an integral basis for $\mathbb{A} \cap \Q[\theta]$.

\item[35. (g)] Let $p$ be an odd prime.  Use exercise 23 to show that $\disc{\theta} = \pm p^{(p-3)/2}$.  Show the plus sign must hold.

By Exercise 23,
\begin{eqnarray*}
\disc{1, \w, \theta, \theta\w, \ldots, \theta^{n-1}} &=&
    \disc{\theta}^2 \text{N}^{\Q[\theta]}_{\Q} \text{disc}^{\Q[\w]}_{\Q[\theta]}(\w) \\
    p^{p - 2} &=& \disc{\theta}^2 \text{N}^{\Q[\theta]}_{\Q} (2\w - \theta) \\
    &=& \disc{\theta}^2 \text{N}^{\Q[\theta]}_{\Q} (\w - \w^{-1}) \\
    &=& \disc{\theta}^2 \text{N}^{\Q[\theta]}_{\Q} (\w^{-1}(\w + 1 )(\w - 1))\\
    &=& \disc{\theta}^2 p\\
    \pm p^{(p - 3)/2} &=& \disc{\theta}
\end{eqnarray*}
As pointed out in the exercise, the square root of the discriminant is present in $\Q[\theta]$.  Since $\Q[\theta] \subseteq \R$, $\disc{\theta} = p^{(p-3)/2}$.

\item[37.] Let $\alpha$ be an algebraic integer of degree $n$ over $\Q$ and let $f$ and $g$ be polynomials over $\Q$, each of degree $< n$, such that $f(\alpha) = g(\alpha)$.  Show $f = g$.

Let $h(x)$ be the minimal polynomial for $\alpha$.  If $f(\alpha) = g(\alpha)$, then $(f - g)(\alpha) = 0$.  Since $h$ is the minimum polynomial for $\alpha$, $h \mid f - g$.  However, $f - g$ has degree $< n$, and so $f - g = 0$.  Therefore $f = g$.

\item[40. (a)] Show $\disc{\alpha} = (d_1 d_2 \cdots d_{n-1})^2 \disc{R}$.

We first show $\disc{\alpha} = \disc{1, f_1(\alpha), \ldots, f_{n-1}(\alpha)}$.  \[ \disc{\alpha} = \disc{1, \alpha, \ldots, \alpha^{n-1}} \]  Since $f_{n-1}$ is a monic polynomial with degree $n-1$ it is a linear combination of $\alpha, \ldots, \alpha^{n-1}$, and so generate the same additive subgroup of $R_{k}$.  By Exercise 26, \[ \disc{1, \alpha, \ldots, \alpha^{n-1}} = \disc{1, \alpha, \ldots, \alpha^{n-2}, f_{n-1}(\alpha)} \]  Proceeding in this way we have \[ \disc{\alpha} = \disc{1, f_1(\alpha), \ldots, f_{n-1}(\alpha)} \]
Finally, we have
\begin{eqnarray*}
    \disc{R} &=& \disc{1, f_1(\alpha)/d_1, \ldots, f_{n-1}(\alpha)/d_{n-1}} \\
    &=& \frac{1}{d_1^2 \cdots d_{n-1}^2} \disc{1, f_1(\alpha)/d_1, \ldots, f_{n-1}(\alpha)/d_{n-1}} \\
    &=& \frac{1}{(d_1 \cdots d_{n-1})^2} \disc{\alpha} \\
\end{eqnarray*}
Multiplying both sides by $(d_1 \cdots d_{n-1})^2$ gives the required result.

\item[40. (b)] We show that $R_{k} / \Z[\alpha]$ has order $d_1, \ldots, d_k$ by induction on $k$.  Since $R = R_{n-1}$ the result with follow by induction.

For the base case we see that $1 / \Z[\alpha]$ has order 1.  Next let $R_{k} = R_{k-1} \oplus\frac{1}{d_k} f_k(\alpha) \Z$, so \[ R_{k} / \Z[\alpha] = R_{k-1}/\Z[\alpha] \oplus \frac{1}{d_k} f_k(\alpha)/\Z[\alpha] \]

By induction $R_{k-1}/\Z[\alpha]$ has order $d_1\cdots d_{k-1}$.  $f_{k}$ is a monic polynomial in $\alpha$ and so $f_k(\alpha) \in \Z[\alpha]$, therefore $\frac{1}{d_k} f_k(\alpha)/\Z[\alpha] = \frac{1}{d_k}$ which has order $d_k$, so the order of $R_k = d_1 \cdots d_{k}$.

\item[40. (c)] Show if $i + j < n$ then $d_i d_j \mid d_{i+j}$.

Since $f_i(\alpha) / d_i$ and $f_j(\alpha) / d_j$ are members of the ring $R$, $f_i(\alpha)f_j(\alpha) / d_i d_j$ must also be a member of the ring $R$.  $f_i(\alpha)f_j(\alpha)$ has order $i + j$.  Since this is $< n$, this element by be generated by the basis elements of order $\le i + j$.  Let $a_{k}$ be the integers that generate this element.  Then
\begin{eqnarray*}
    \frac{f_i(\alpha)f_j(\alpha)}{d_i d_j} &=& a_{i+j}\frac{f_{i+j}(\alpha)}{d_{i+j}} + \sum_{k = 0}^{i + j - 1} a_k \frac{f_{k}(\alpha)}{d_k} \\
    f_i(\alpha)f_j(\alpha) &=& a_{i+j}d_{i}d_{j}\frac{f_{i+j}(\alpha)}{d_{i+j}} + \text{Lower terms}
\end{eqnarray*}

We know $a_{i+j} \neq 0$.  Since $f_i$, $f_j$, and $f_{i+j}$ are each monic, the denominator must cancel with no remainder, giving $d_{i+j} = a_{i+j} d_i d_j$.  Therefore $d_i d_j \mid d_{i+j}$.

\item[40. (d)] Take $\frac{f_1(\alpha)}{d_1}$ as the basis element of order 1, and raise this element to the $i$-th power.  Each $(\frac{f_1(\alpha)}{d_1})^i$ is a polynomial of order $i$ and so generated by the basis element $\frac{f_i(\alpha)}{d_i}$.  By a similar argument as in 40. (c) (each of these terms is a monic polynomial and so the denominators must cancel with no remainder), $d_1^i \mid d_i$.

Let $j_i$ be the remainder left when dividing $d_i$ by $d_1^i$ ($j_1 = 1$).  Then:
\begin{eqnarray*}
    \disc{\alpha} &=& (d_1 \cdots d_{n-1})^2 \disc{R} \\
                  &=& (d_1 d_1^2 \cdots d_1^{n-1} \prod_{i=0}^{n-1} j_i)^2 \disc{R} \\
                  &=& (d_1^{n(n-1)/2})^2 (\prod_{i=0}^{n-1} j_i)^2 \disc{R}\\
                  &=& d_1^{n(n-1)} (\prod_{i=0}^{n-1} j_i)^2 \disc{R}
\end{eqnarray*}
Therefore $d^{n(n-1)} \mid \disc{\alpha}$.

\item[41. (a)] Let $m$ be a cubefree integer, $\alpha = \sqrt[3]{m}$, and write $m$ as $hk^2$ with $h, k$ relatively prime.  Let $R = \mathbb{A} \cap \Q[\alpha]$.  (Therefore $k^2$ has any square factors of $m$.).  Show $\disc{\alpha} = -27m^2$ (the 2018 edition has a typo).

Let $f(x) = x^3 - m$; $f(x)$ is the minimum polynomial of $\alpha$ over $\Q$ and has degree 3 (not $\equiv 0, 1\ (4)$), so $\disc{\alpha} = -\norm{f'(\alpha)}$.  $f'(\alpha) = 3\alpha^2$ so $\alpha f'(\alpha) = 3m$ and $f'(\alpha) = 3m / \alpha$.  Note $\norm{\alpha} = m$ so $\norm{\alpha^{-1}} = 1/m$.  Therefore we have
\begin{gather*}
    \norm{3m/\alpha} = 27m^3 \norm{\alpha^{-1}} = 27m^2 \\
    \disc{\alpha} = -27m^2
\end{gather*}
Using Exercise 40, we see $-27m^2 = (d_1 d_2)^2 \disc{R}$ and $d_1^2 | d_2$, so writing $d_2 = d_1^2 j$, we have \[ -27m^2 = d_1^4 j^2 \disc{R} \]

Since $d_1$ has a sextic factor on the righthand-size, the only possibilities for $d_1$ are 1 or 3.  If $d_1 = 3$ then $9 \mid m$.

\item[41. (b)]  Show $d_1 = 1$ even when $9 \mid m$.

Suppose $9 \mid m$ and $d_1 = 3$.  Then $R$ has an integral basis with $1$ and $(\alpha + a)/3$ as two of the three basis vectors.

Let $\beta = (\alpha + a) / 3$ for some integer $a$.  As suggested in the exercise hint we consider the trace of $\beta^3$.  First, we determine the trace of $\alpha$ and $\alpha^2$ as these will be important to evaluate $\trace{\beta}$.
\begin{gather*}
    \trace{\alpha} = \alpha + \w\alpha + \w^2\alpha = \alpha(\w^2 + \w + 1) = 0\\
    \trace{\alpha^2} = \alpha^2 + \w^2 \alpha^2 + \w\alpha^2 = \alpha^2(\w^2 + \w + 1) = 0
\end{gather*}
With these in hand we now have \[ \beta^3 = \frac{(\alpha + a)^3}{27} = \frac{m + 3\alpha^2 a + 3a^2 \alpha + a^3}{27} \]

By the additive linearity of trace, we have
\begin{eqnarray*}
    \trace{\beta^3} &=& \frac{m}{9} + \frac{3a}{27}\trace{\alpha^2} + \frac{3a^2}{27}\trace{\alpha} + \frac{3a^3}{27}\\
    &=& \frac{m}{9} + \frac{3a^3}{27} \\
    &=& \text{Integer} + \frac{3a^3}{27}
\end{eqnarray*}

Since $\beta$ is an algebraic integer, $\beta^3$ is also an algebraic integer, and its trace must be a member of $\Z$.  Therefore $\frac{3a^3}{27}$ must be an integer, and so $27$ must divide $3a^3$, which means that $9$ divides $a^3$ and so 3 divides $a$.

Since 3 divides $a$, $\frac{\alpha + a}{3} = \frac{\alpha}{3} + \text{Integer}$.  Therefore $\alpha/3$ is a member of $R$, so $(\alpha / 3)^3 = m / 27 \in R$.  However, $m$ is cubefree and so $m / 27 \not \in \Z$.  This contradicts Corollary 1 of Theorem 1 - the only members of $\Q$ that are algebraic integers are members of $\Z$.

Therefore $d_1 = 1$ in all cases, and so $R$ has a basis containing $1$ and $\alpha$.  The third basis vector has yet to be determined.

\item[41. (c)] Write $m$ as $hk^2$.  Then $(\alpha^2 / k)^3 = m^2 / k^3 = (h^2 k^4)(k^3) = h^2 k$, and so $\alpha^2 / k$ is the root of the polynomial $f(x) = x^3 - h^2k$, and so $\alpha^2 / k \in R$.

\item[41. (d)] Suppose $m \equiv \pm 1\ (9)$.  Let $\beta = (\alpha \mp 1)^2 / 3$.  Show that
\[ \beta^3 - \beta^2 + \frac{1 \pm 2m}{3} \beta - \frac{(m \mp 1)^2}{27} = 0 \]

As suggested we calculate $(\beta - 1/3)^3$ in two ways:
\begin{eqnarray*}
(\beta - 1/3)^3 &=& ((\alpha \mp 1)^2 / 3 - 1/3)^3 \\
\beta^3 - \frac{3\beta^2}{3} + \frac{3\beta}{9} - \frac{1}{27} &=& \frac{(\alpha(\alpha \mp 2))^3}{27} \\
\beta^3 - \beta^2 + \frac{\beta}{3} - \frac{1}{27} &=& m\left(\frac{m \mp 6\alpha^2 + 12\alpha \mp 8}{27}\right)\\
\beta^3 - \beta^2 + \frac{\beta}{3} - \frac{m^2 \mp 2m + 1}{27} &=& m\left( \frac{\mp 6\alpha^2 + 12\alpha \mp 6}{27}\right)\\
\beta^3 - \beta^2 + \frac{\beta}{3} - \frac{(m \mp 1)^2}{27} &=& \mp \frac{2m}{3}\left( \frac{\alpha^2 \pm 2\alpha + 1}{3}\right) = \mp \frac{2m}{3}\beta
\end{eqnarray*}
Moving the terms around, we have the required result:
\[ \beta^3 - \beta^2 + \frac{1 \pm 2m}{3}\beta - \frac{(m \mp 1)^2}{27} = 0 \]

Since $m \equiv \pm 1\ (9)$, $1 \pm 2m$ is divisible by 3, and $m \mp 1$ is divisible by 9, so $(m \mp 1)^2$ is divisible by 27.  Therefore $\beta$ is the root of a monic polynomial with integer coefficients and so $\beta \in R$.

\item[41. (e)] Using (c) and (d), show that if $m \equiv \pm 1\ (9)$ then
\[ \frac{\alpha^2 \pm k^2 \alpha + k^2}{3k} \in R \]

Since $\alpha^2 / k \in R$, we can adding $k\alpha + k$ to the element to see that \[ \frac{\alpha^2 + k^2\alpha + k^2}{k} \in R \]

Next, observe that $\modequiv{k^2}{1}{3}$ - it cannot be 0 since $\modequiv{m}{\pm 1}{9}$.  Therefore $(k^2 - 1)/3$ and $(k^2 + 2)/3$ are integers.  Taking $(\alpha^2 \mp 2\alpha + 1)/3$, we add $(k^2 - 1)/3$ to see that \[ \frac{\alpha^2 \mp 2\alpha + k^2}{3} \in R \]

Next we have
\[ \frac{\alpha^2 \mp 2\alpha + k^2}{3} \pm \frac{\alpha(k^2 - 2)}{3} = \frac{\alpha^2 \pm k^2\alpha + k^2}{3} \in R \]

Since $3 \nmid k$ and 3 is a prime, there exist integers $a, b$ such that $3a + bk = 1$.  Therefore
\begin{eqnarray*}
    b\left(\frac{\alpha^2 \pm k^2\alpha + k^2}{3}\right) + a\left(\frac{\alpha^2 \pm k^2\alpha + k^2}{k}\right) &=& \frac{(kb + 3a)(\alpha^2 \pm k^2\alpha + k^2)}{3k} \\
    &=& \frac{\alpha^2 \pm k^2\alpha + k^2}{3k} \in R
\end{eqnarray*}

This is the required result.

\item[41. (f)]  We have $\disc{\alpha} = -27m^2$.  By Exercise 40(a), $d_2^2 \disc{R} = \disc{\alpha} = -27m^2 = -27h^2 k^4$.  We know $k \mid d_2$ so write $d_2 = jk$, thus $j^2 k^2 \disc{R} = -27h^2 k^4$ and so $j^2 \disc{R} = -27h^2 k^2 = -27mh$.  By assumption $h$ is squarefree, so $j^2 \mid -27m$, implying either $j \mid 3$ or $j \mid m$.  Therefore $j \mid 3m$.

\item[41. (g)]  Letting $p$ be a prime such that $p \neq 3$, $p \mid m$, $p^2 \mid m$.  Let $p \mid d_2$, and write $d_2 = pj$.  Therefore if $(\alpha^2 + a\alpha + b) / d_2 \in R$, then \[ j(\alpha^2 + a\alpha + b) / d_2 = (\alpha^2 + a\alpha + b) / p \in R \]  Since $(\alpha^2 + a\alpha + b)/p \in R$, its trace must be an integer; however $\trace{\alpha^2} =\trace{\alpha} = 0$, and so $3b / p \in \Z$.  $p \neq 3$, therefore $p \mid b$.  Therefore $(\alpha^2 + a\alpha) / p \in R$.

\[ \trace{((\alpha^2 + a\alpha)/p)^3} = \trace{(m^2 + a^3 m)/p^3} \]

Therefore $p^3 \mid 3(m^2 + a^3 m)$.  Since $p \neq 3$, $p^3 \mid m(m + a^3)$.  $m$ is cubefree and $p^2 \nmid m$, so $p^2 \mid m + a^3$.  Therefore $a^3 \equiv 0\ (p)$, meaning $a \equiv 0\ (p)$.  Considering the equation modulo $p^2$ we then have $m \equiv 0\ (p^2)$, a contradiction.  Therefore this case is impossible.

\item[41. (h)] Let $p \neq 3$ and $p^2 \mid m$.  By the previous problem $(\alpha^2 + a\alpha)/p^2 \in R$ and so we consider the trace:
\[ \trace{((\alpha^2 + a\alpha)/p^2)^3} = \trace{(m^2 + a^3 m)/p^6} \]
Therefore $p^6 \mid m(m + a^3)$.  Since $p^2 \mid m$, $p^4 \mid m + a^3$.  Considering the equation modulo $p^2$, we must have $a^3 \equiv 0\ (p^2)$, so $p^2 \mid a^3$.  Therefore $p \mid a$ and so $p^3 \mid a^3$.  Therefore $m + a^3 \equiv 0\ (p^3)$ and so $m \equiv 0\ (p^3)$ again contradicting $m$ cubefree.

Together with (g) this shows that $d_2$ has no common prime factor with $m$ that is not equal to 3.

\item[41. (i)] Take $(\alpha^2 + a\alpha + b)/d_2$.
\begin{eqnarray*}
    \frac{(\alpha^2 + a\alpha + b)^2}{d_2^2} &=& \frac{m\alpha + 2am + 2\alpha^2b + a^2\alpha^2 + 2ab\alpha + b^2}{d_2^2} \\
     &=& \frac{\alpha^2 (a^2 + 2b) + \alpha(m + 2ab) + (2am + b^2)}{d_2^2}
\end{eqnarray*}
Since this is an element of the ring and the basis element of order 2 has denominator $d_2$, $d_2$ must divide each of $a^2 + 2b$, $m + 2ab$, and $2am + b^2$.

\item[41. (j)]  We now consider what power of 3 divides $d_2$.  We know $d_2 \mid 3m$.  If $3 \nmid m$, then $9 \nmid d_2$.  Therefore, if $m \equiv \pm 1\ (9)$, $d_2 = 3k$; it cannot be any non-3 prime dividing $m$ by (g) and (h), and 9 does not divide $m$.

We now consider the case where $m \nequiv \pm 1\ (9)$ and $3 \nmid m$.  We assume $3 \mid d_2$ (to show a contradiction).

We evaluate the congruences obtained in (i) modulo 3.  Since $a^2 + 2b \equiv 0\ (3)$, $a^2 - b \equiv 0\ (3)$, and so $b \equiv a^2\ (3)$.  Substituting $b$ with $a^2$ in the equation $m + 2ab \equiv 0\ (3)$, we have $m + 2a^3 \equiv 0\ (3)$ and so $m - a^3 \equiv m - a \equiv 0\ (3)$, so therefore $a \equiv m\ (3)$.  Substituting $m$ for $a$ in the equivalence $b^2 + 2am \equiv 0\ (3)$, we have $b^2 \equiv -2a^2 \equiv a^2 \ (3)$.  Therefore since $a^2 + 2b \equiv 0\ (3)$, we have $b(b + 2) \equiv b(b - 1) \equiv 0\ (3)$.  $b \not\equiv 0\ (3)$ (as this would imply $m \equiv 0\ (3)$) so we must have $b \equiv 1\ (3)$.

Therefore we can write the basis element of order 2 as $\frac{\alpha^2 + (m + 3l)\alpha + (3j + 1)}{3i}$ for some $i, l, j$, and so by multiplying through by $i$ and subtracting the term $3l\alpha + 3j$ from the resulting fraction, we have:

\[ \frac{\alpha^2 + m\alpha + 1}{3} \in R \]

We now proceed by case on $m$ congruence to 3.  (Almost there!)

Suppose $\modequiv{m}{1}{3}$.  Then $\frac{\alpha^2 + \alpha + 1}{3} \in R$ and so by subtracing $\alpha$, $\frac{\alpha^2 - 2\alpha + 1}{3} = \frac{(\alpha - 1)^2}{3} \in R$.

We raise this to the fourth power and take the trace.  The only terms that contribute to the trace are those where $\alpha$ is raised to a power divisible by 3, so we have:
\begin{eqnarray*}
    \trace{\frac{(\alpha - 1)^8}{3^4}} &=& \frac{3}{3^4}\left(\binom{8}{6}\alpha^6 (-1)^2 + \binom{8}{3}\alpha^3 (-1)^5 + (-1)^8\right)\\
    &=& \frac{1}{27} \left(28m^2 - 56m + 1\right)
\end{eqnarray*}

Therefore, 27 must divide $28m^2 - 56m + 1$.  Congruent to 9, this equation reduces to $m^2 - 2m + 1 \equiv 0\ (9)$ so $(m - 1)^2 \equiv 0\ (9)$ and $\modequiv{m}{1}{9}$.  This contradicts $m \not\equiv \pm 1\ (9)$.  So $m$ cannot be congruent to 1 mod 3.

Next, suppose $m \equiv 2\ (3)$.  Threefore $\frac{\alpha^2 + 2\alpha + 1}{3} = \frac{(\alpha + 1)^2}{3} \in R$.  Again we raise this to the fourth power and take the trace.  (The equation is the same except for the negative terms.)

\[ \trace{\frac{(\alpha + 1)^8}{3^4}} = \frac{1}{27}\left(28m^2 + 56m + 1\right) \]
Modulo 9 we have $\modequiv{m^2 + 2m + 1}{0}{9}$ so $\modequiv{(m+1)^2}{0}{9}$ and so $\modequiv{m}{-1}{9}$, again contradicting $\modnotequiv{m}{\pm 1}{9}$.

Therefore if $3 \nmid m$ and $\modnotequiv{m}{\pm 1}{9}$, $3 \nmid d_2$.

\item[41. (k)]  Suppose $3 \mid m$ but $9 \nmid m$.  We assume $3 \mid d_2$ to show a contradiction.  By (i), $\modequiv{a^2 + 2b}{0}{3}$, so $\modequiv{a^2}{b}{3}$ (*).  Plugging this into $\modequiv{m + 2ab}{0}{3}$ we have $\modequiv{m - a^3}{0}{3}$.  Since $\modequiv{a^3}{a}{3}$, we thus have $\modequiv{m}{a}{3}$ and so $\modequiv{a}{0}{3}$, and also $\modequiv{b}{0}{3}$ by (*).

Therefore we can write the basis element of order 2 as $\frac{\alpha^2 + 3i\alpha + 3j}{3l}$, and by multiplying through by $l$ and subtracting $i\alpha + j$, we have $\frac{\alpha^2}{3} \in R$.  Cubing this element and taking the trace we must have $m^2  / 9 \in \Z$, contradicting $9 \nmid m$.  Therefore $3 \nmid d_2$.

\item[41. (l)]  Suppose $9 \mid m$.  We show $9 \nmid d_2$.  Assume $9 \mid d_2$ (to show a contradiction).  By (i), $9 \mid ab$ and $9 \mid b^2$ so either $9 \mid b$ or $3 \mid b$.  Assume $3 \mid b$, therefore since $\modequiv{a^2 + 2b}{0}{9}$, we must have $\modequiv{a^2}{-6 \equiv 3}{9}$.  However, 3 is not the square of any element mod 9, so this equation is unsatisfiable.  We must have $9 \mid b$.

Therefore, $(a^2 + a\alpha) / 9 \in R$.  Taking this to the third power and considering the trace, we must have $9^3 \mid 3(m^2 + ma^3)$ and $9^2 3 \mid m(m + a^3)$.  Since $m$ is cubefree and $9 \mid m$, therefore $27 \mid m + a^3$.  Considering $m + a^3$ modulo 9, we have $\modequiv{a^3}{0}{9}$; therefore $a$ must be congruent to 0, 3, or 6 modulo 9.  In all these cases we have $\modequiv{a^2}{0}{9}$.  Since $9^2 \mid a^3$ and $9^2 \mid (m + a^3)$, $9^2 \mid m$, which contradicts $m$ being cube-free.  Therefore $9 \nmid d_2$.

\item[43. (a)] Let $f(x) = x^5 + ax + b$ with $a, b \in \Z$ and $f$ irreducible over $\Q$.  Let $\alpha$ be a root of $f$.  Show $\disc{\alpha} = 4^4 a^5 + 5^5 b^4$.

We proceed in a similar fashion to Exercise 28: first, we determine $f'(\alpha)$, then we determine $\norm{f'(\alpha)}$ by collecting the most and least significant the coefficients of its polynomial.

$f'(x) = 5x^4 + a$, so $\alpha f'(x) = 5\alpha^5 + a = -5(a\alpha + b) + a = -4a \alpha - 5b$ and $f'(\alpha) = (-4a\alpha - 5b) / \alpha$.  The expression $4a\alpha + 5b$ is a root of the polynomial $(\frac{x - 5b}{4a})^5 + a(\frac{x - 5b}{4a}) + b$.  The norm $\norm{4a\alpha + 5b}$ is the negative of the $x^0$ coefficient divided by the $x^5$ coefficient (again, negative because 5 is odd), so we calculate those values.

The $x^0$ coefficient is $(\frac{-5b}{4a})^5 + a(\frac{-5b}{4a}) + b = (\frac{-5b}{4a})^5 + \frac{-b}{4}$, and the $x^5$ coefficient is $(\frac{1}{4a})^5$, so $\norm{4a\alpha + 5b} = 5^5 b^5 + 4^4 a^5 b$.

Therefore, \[ \disc{\alpha} = \norm{-(4a\alpha + 5b)/\alpha} = -\frac{5^5 b^5 + 4^4 a^5 b}{-b} = 5^5 b^4 + 4^4 a^5 \]  This is the required result.  (The plus sign for the discriminant holds because $5 \equiv 1\ (4)$)

\item [43. (b)] Suppose $\alpha^5 = \alpha + 1$.  We are given that this polynomial is irreducible because it is irreducible modulo 3.  (The options are $0$, $1$, and $2$: $0^5 \not\equiv 0 + 1\ (3)$, $1^5 \not\equiv 1 + 1\ (3)$, and $2^5 = 2 \not\equiv 1 + 2 = 0\ (3)$.)

In this case $a = -1$ and $b = -1$ so the above formula gives $\disc{\alpha} = 5^5 - 4^4 = 125 \cdot 25 - 16 \cdot 16 = 2869 = 19 \cdot 151$.  Since the discriminant is squarefree, $\mathbb{A} \cap \Q[\alpha] = \Z[\alpha]$.

\item[43. (c)] Let $a$ be squarefree and not equal to $\pm 1$.  Let $\alpha$ be a root and $d_1, d_2, d_3, d_4$ be as in Theorem 13.  Prove that if $4^4 a + 5^5$ is squarefree then $d_1 = d_2 = 1$ and $d_3 d_4 \divides a^2$.

By exercise 40, \[ \disc{\alpha} = 5^5 a^4 + 4^4 a^5 = a^4(5^5 + 4^4 a) =(d_1 d_2 d_3 d_4)^2 \disc{R} \]

Here $d_1 d_2 \divides d_3$, $d_1 d_2 \divides d_4$, and $d_1 d_3 \divides d_4$.  Therefore $d_1$ and $d_2$ both have 6 factors represented in the $\disc{\alpha}$ expression which is impossible unless they are both $1$.  Since $5^5 + 4^4 a$ is squarefree, $(d_3 d_4)^2$ must divide $a^4$ and so $d_3 d_4 \divides a^2$.

Verify that $4^4 a + 5^5$ is squarefree when $a = -2, -3, -6, -7, -10, -11, -13$, and $-15$.

\begin{verbatim}
sage: [(factor(x), is_squarefree(x)) for x in
       map(lambda a: 5^5 + 4^4 *a,
       [-2, -3, -6, -7, -10, -11, -13, -15])]

[(3 * 13 * 67, True),
    (2357, True),
    (7 * 227, True),
    (31 * 43, True),
    (5 * 113, True),
    (3 * 103, True),
    (-1 * 7 * 29, True),
    (-1 * 5 * 11 * 13, True)]
    \end{verbatim}

    Experimenting a bit more with Sage, we can quickly test integers using the following code:
    \begin{verbatim}
sage: def test_poly_degree_5(a):
....:     return (is_squarefree(5^5 + 4^4 *a) and
....:             is_squarefree(a))
....:
sage: filter(lambda x: test_poly_degree_5(x),
....:        range(2, 30))
[2, 3, 5, 6, 7, 10, 11, 14, 15, 17, 19, 21, 23, 26, 29]
sage: filter(lambda x: test_poly_degree_5(x),
....:        range(-2, -30, -1))
[-2, -3, -6, -7, -10, -11, -13, -15, -17, -19, -21,
 -22, -26, -29]
\end{verbatim}

\item[43. (d)] Let $\alpha$ be as in part (c) ($\alpha$ is the root of a polynomial $f(x) = x^5 + ax + a$).  Show $\alpha + 1$ is a unit.

We have $\alpha^5 = -a(\alpha + 1)$, so we take the norm of both sides.  $\norm{\alpha^5} = -a^5 = \norm{-a} \norm{\alpha + 1} = -a^5 \norm{\alpha+1}$, so $\norm{\alpha + 1} = 1$.  Therefore $\alpha + 1$ is a unit in $\mathbb{A} \cap \Q[\alpha]$.

\item[44. (a)] Let $f(x) = x^5 + ax^4 + b$ where $a, b \in \Z$, and let $\alpha$ be a root of $f$.  To determine the discriminant of $\alpha$, we proceed as in exercise 28 and 43.  The derivative of $f(x)$ is $f'(x) = 5x^4 + 4ax^3$, so  \[ f'(\alpha) = \alpha^3(5\alpha + 4a) \]  $\norm{a^3} = -b^3$ so determine the norm of $5\alpha + 4a$ by observing it is the root of the polynomial $(\frac{x - 4a}{5})^5 + (\frac{x - 4a}{5})^4 + b$.  The $x^0$ term is $(\frac{-4a}{5})^5 + (\frac{-4a}{5})^4 + b$ while the $x^5$ term is $\frac{1}{5^5}$, \[ \norm{5\alpha + 4a} = (4a)^5 - 5a (4a)^4 - 5^5 b = -(4a)^5 \cdot (-4 + 5) - 5^5 b = -(4^5 a^5 + 5^5 b) \]  Therefore $\disc{\alpha} = (4^5 a^5 + 5^5 b)b^3$ as required (the discriminant is positive since $5 \equiv 1\ (4)$).

\item[44. (b)] TODO

\item[45.] Let $\alpha$ be the root of the polynomial $f(x) = x^n + ax + b$.  Find a formula for $\disc{\alpha}$.

We proceed in similar fashion to exercise 43. $f'(\alpha) = n\alpha^{n-1} + a$, so we have:
\begin{eqnarray*}
    \alpha f'(\alpha) &=& n\alpha + a\alpha \\
                      &=& -n(a \alpha + b) + a\alpha \\
                      &=& -((n - 1)a \alpha + bn) \\
    f'(\alpha) &=& -((n - 1)a \alpha + bn) / \alpha
\end{eqnarray*}

We now calculate $\norm{(n - 1)a \alpha + bn)}$.  This is the root of the poylnomial
\[ g(x) = \left(\frac{x - bn}{(n-1)a}\right)^n + a \left(\frac{x - bn}{(n-1)a}\right) + b\]

The norm is equal to $(-1)^n$ times the $x_0$ coordinate multiplied by the inverse of $x_n$ coordinate.  Therefore,

\[ \norm{(n-1)a \alpha + bn} = (bn)^n + (-1)^{n + 1} a^n b (n -1)^{n-1} \]

The inverse of the $x_n$ coordinate is seen to be $((n - 1)a)^n$

The discriminant is then (with the $\pm$ positive if $n \equiv 0, 1\ (4)$, negative otherwise):
\begin{eqnarray*}
    \disc{\alpha} &=& \frac{\pm (-1)^n \norm{(n - 1)a \alpha + bn}}{b(-1)^n}\\
    &=& \frac{\pm (bn)^n + (-1)^{n + 1} a^n b (n -1)^{n-1}}{b} \\
    &=& \pm [b^{n-1} n^n + (-1)^{n + 1} a^n (n -1)^{n-1}]
\end{eqnarray*}

Plugging values in gives:
\begin{eqnarray*}
    n = 2 &=& -(2^2 b -  a^2) = a^2 - 4b \\
    n = 3 &=& -(27b^2) + a^3 2^2) = -27b^2 + 4a^3 \\
    n = 4 &=& b^3 4^4 - a^4 3^3 = 256b^3 - 27a^4 \\
    n = 5 &=& b^4 5^5 + a^5 4^4
\end{eqnarray*}
These agree with the known values of these polynomials.

Next, we calculate $\disc{\alpha}$ if $\alpha$ is a root of $x^n + ax^{n-1} + b$.  The derivative $f'(\alpha) = n\alpha^{n-1} + a(n-1)\alpha^{n-2} = \alpha^{n-2}(\alpha n + a(n-1))$, so \[ \disc{\alpha} = \pm \norm{f'(\alpha)} = \pm \norm{\alpha^{n-2}}\norm{n\alpha + (n-1)a} \]

The norm $\norm{\alpha^{n-2}} = \norm{\alpha}^{n-2} = (-1)^{n} b^{n-2}$, so we only need to calculate $\norm{n\alpha + (n-1)a}$.  This is a root of the polynomial \[ \left(\frac{x - (n-1)a}{n}\right)^n + a\left(\frac{x - (n-1)a}{n}\right)^{n-1} + b \]

We now calculate the norm of this.  The $x_n$ coefficient is $\frac{1}{n^n}$, and the $x_0$ coefficient is \[ \left(-\frac{(n-1)a}{n}\right)^n + a\left(-\frac{(n-1)a}{n}\right)^{n-1} + b \]

Multiplying through by $n^n$ gives us:
\begin{eqnarray*}
    \norm{n\alpha + (n-1)a} &=& (-1)^n[(-1)^n (n-1)^n a^n + (-1)^{n-1} a^n (n-1)^{n-1} n + b n^n] \\
    &=& (n-1)^n a^n - a^n (n-1)^{n-1} n + (-1)^n b n^n \\
    &=& a^n (n - 1)^{n-1}(n-1 - n) + (-1)^n bn^n \\
    &=& -a^n (n - 1)^{n-1} + (-1)^n bn^n
\end{eqnarray*}
Multiplying the norm by $(-1)^n b^{n-2}$ we have
\[ \disc{\alpha} = \pm [ bn^n + (-1)^{n-1} a^n (n - 1)^{n-1}] b^{n-2} \]
This agrees with the answer to Exercise 44 (a) ($n = 5$) and I confirmed via Sage that the formula holds for some examples where $n = 4$ and $n = 6$:
\begin{verbatim}
sage: a = 4; b = -7; n = 4
sage: K.<g> = QQ.extension(x^4 + a*x^3 + b)
sage: K.disc([1, g, g^2, g^3])
-426496
sage: (b*n^n - a^n * (n - 1)^(n - 1))*b^(n-2)
-426496
sage: a = 3; b = -5; n = 6
sage: K.<g> = QQ.extension(x^6 + a*x^5 + b)
sage: K.disc([1, g, g^2, g^3, g^4, g^5])
1569628125
sage: -(b*n^n - a^n * (n - 1)^(n - 1))*b^(n-2)
1569628125
\end{verbatim}

\end{enumerate}

\section*{Chapter 3}

\begin{enumerate}
    \item[2.] Prove that every finite integral domain $D$ is a field.

    For $\alpha \in D$, consider the set $\{1, \alpha, \alpha^2, \ldots\}$.  Since $D$ is finite this set must also be finite, so there must be some $i, j$, $i \neq j$ such that $\alpha^i = \alpha^j$.  Thus $\alpha^{j - i} = 1$, and $\alpha^{j - i - 1}\alpha = \alpha^{j - i} = 1$, so every element in $D$ has an inverse, and $D$ is therefore a field.

    \item[3.] Let $G$ be a free abelian group of rank $n$, with additive notation.  Show for any $m \in \Z$, $G / mG$ is the direct sum of $n$ cyclic group of order $m$.

    Since $G$ is a free abelian group of rank $n$, \[ G \simeq \underbrace{\Z \oplus \cdots \oplus \Z}_\text{$n$ copies} \]
    Therefore \[ G/mG \simeq \underbrace{\Z/m\Z \oplus \cdots \oplus \Z/m\Z}_\text{$n$ copies} \]
    Each $\Z/m\Z$ is a cyclic group of order $m$, so the order of $G/mG$ is $m^n$.

    \item[4.] Let $K$ be any number field of degree $n$ over $\Q$.  Prove that every nonzero ideal $I$ in $R = \ringofintegers{K}$ is a free abelian group of rank $n$.

    As an additive subgroup of $R$, $I$ must be a free abelian group of order $\le n$.  Let $\{\beta_1, \ldots, \beta_n\}$ be a basis for $R$, and take $\alpha \in I$.  $\{\alpha\beta_1, \ldots, \alpha\beta_n\} \subseteq I \subseteq R$ is a free abelian group of order $n$.  Since $I$ contains $\alpha I$, the rank of $I$ must also be $n$.

    \item[8.] If $I + J = 1$ then there exist $\alpha \in I, \beta \in J$ such that $\alpha + \beta = 1$.  Raising both powers to the $m + n$th power, we have $(\alpha + \beta)^{m + n} = 1^{m + n} = 1$.  By the binomial theorem, $(\alpha + \beta)^{m + n} = \sum_{k = 0}^{m + n} \binom{m + n - k}{k}\alpha^{m + n - k}\beta^{k}$.  If $k < n$, this element is a member of $I^{m}$ (as $\alpha^{n + \text{positive}} \in I^{m}$); otherwise this element is a member of $J^{n}$.  Therefore $(\alpha + \beta)^{m + n} \in I^{m} + J^{n}$.

    \item [18. (a)]  Show $\disc{r\alpha_1, \alpha_2, \ldots, \alpha_n} = r^2 \disc{\alpha_1, \ldots, \alpha_n}$.

    Writing the discriminant as the determinant of each of the $\sigma_j$ conjugates of $\alpha_n$, we have:
    \[ \disc{r\alpha_1, \alpha_2, \ldots, \alpha_n} = \left|\ \begin{matrix}
        \sigma_1(r\alpha_1) & \cdots & \sigma_k(\alpha_n)
        \\
        \sigma_2(r\alpha_1) & \cdots & \sigma_k(\alpha_n)
        \\
        \vdots & \ddots & \vdots \\
        \sigma_k(r\alpha_1) & \cdots & \sigma_k(\alpha_n) \\
    \end{matrix}\ \right|^2 \]
    Let $A_{ij}$ be the matrix minor corresponding to row $i$, column $j$.  Since $r \in \Q$, $\sigma_k(r\alpha_1) = r\sigma_k(\alpha_1)$ for all $k$.  Taking the determinant along the first column, we have:
    \begin{eqnarray*}
        \disc{r\alpha_1, \alpha_2, \ldots, \alpha_n} &=& \left(\sum_{i = 0}^{n} (-1)^i \sigma_i(r\alpha_1) A_{1i}\right)^2\\
        &=& \left(\sum_{i = 0}^{n} (-1)^i r\sigma_i(\alpha_1) A_{1i}\right)^2\\
        &=& r^2 \left(\sum_{i = 0}^{n} (-1)^i \sigma_i(\alpha_1) A_{1i}\right)^2\\
        &=& r^2 \disc{\alpha_1, \ldots, \alpha_n}
    \end{eqnarray*}

    \item[18. (b)] Let $\beta$ be a linear combination of $\alpha_2, \ldots, \alpha_n$ with coefficients in $\Q$.  Show $\disc{\alpha_1 + \beta, \alpha_2, \ldots, \alpha_n} = \disc{\alpha_1, \ldots, \alpha_n}$.

    For all $\sigma_k$, $\sigma_k(\alpha_1 + \beta) = \sigma_k(\alpha_1) + \sigma_k(\beta)$.  If $\beta = p_2 \alpha_2 + \ldots + p_n \alpha_n$, then $\sigma_k(\beta) = p_2\sigma_k(\alpha_2) + \ldots + p_n\sigma_k(\alpha_n)$ for $p_i \in \Q$.  Writing $\disc{\alpha_1 + \beta, \alpha_2, \ldots, \alpha_n}$ in matrix form, the $k$-th row of the first column has the form $\sigma_k(\alpha_1) + p_2\sigma_k(\alpha_2) + \ldots + p_n\sigma_k(\alpha_n)$.

    Subtracting a column times a linear factor has no effect on the determinant of the matrix, so by subtracting $p_i$ multiplied by column $i$ from the first column for each $i$, we see $\disc{\alpha_1 + \beta, \alpha_2, \ldots, \alpha_n} = \disc{\alpha_1, \ldots, \alpha_n}$.
\end{enumerate}

\end{document}

